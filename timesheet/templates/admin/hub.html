{% extends 'theme/base.html' %}
{% load static %}
{% block content %}

{% block extra_css %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="{% static 'admin/css/graficos.css' %}">
{% endblock %}

<main>
  
  

<div class="chart-container">
  <h2>Status dos Colaboradores</h2>
  <canvas id="chartColaboradores"></canvas>
</div>

<div class="chart-container">
    <h2>Atividades Realizadas por Dia da Semana</h2>
    <canvas id="barChartAtividades"></canvas>
</div>

    
</main>







<script>
document.addEventListener("DOMContentLoaded", function() {
  var ctx = document.getElementById("chartColaboradores").getContext("2d");

  // Pegando os dados do Django
  var labels = JSON.parse('{{ labels|safe }}');
  var values = JSON.parse('{{ values|safe }}');

  var myChart = new Chart(ctx, {
      type: "doughnut",  // Tipo do gráfico
      data: {
          labels: labels,
          datasets: [{
              data: values,
              backgroundColor: ["#36A2EB", "#FF6384"], // Azul e Vermelho
              borderWidth: 1
          }]
      },
      options: {
          responsive: true,
          plugins: {
              legend: {
                  position: "top"
              },
              tooltip: {
                  callbacks: {
                      label: function(tooltipItem) {
                          let total = values.reduce((a, b) => a + b, 0);
                          let percent = ((tooltipItem.raw / total) * 100).toFixed(2);
                          return `${tooltipItem.label}: ${tooltipItem.raw} (${percent}%)`;
                      }
                  }
              }
          }
      }
  });
});
</script>
<!--Gráfico de Barras-->
<script>

document.addEventListener("DOMContentLoaded", function() {
  var ctx = document.getElementById("barChartAtividades").getContext("2d");

  var labels = ["Seg", "Ter", "Qua", "Qui", "Sex", "Sáb"];
  var data = JSON.parse('{{ atividades_por_dia|safe }}'); // Passando os dados do backend

  var barChart = new Chart(ctx, {
      type: "bar",
      data: {
          labels: labels,
          datasets: [{
              label: "Atividades feitas",
              data: data,
              backgroundColor: ["#3498db", "#2ecc71", "#e74c3c", "#f1c40f", "#9b59b6", "#1abc9c"],
              borderWidth: 1
          }]
      },
      options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
              y: {
                  beginAtZero: true,
                  ticks: {
                      stepSize: 1
                  }
              }
          }
      }
  });
});

</script>

{% endblock %}
